<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>LLM Evaluation Comparison</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
<!--<link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css">-->
<!--<script src="https://unpkg.com/vue@3"></script>-->
<!--<script src="https://unpkg.com/element-plus"></script>-->
<style>
body {
  font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  background: #f4f6f8;
  color: #222;
  padding: 28px;
}
.container { max-width: 1200px; margin: 0 auto; }
header { margin-bottom: 24px; }
h1 { font-size: 22px; margin: 0; font-weight: 600; }
p.lead { margin: 6px 0 0; color: #555; font-size: 14px; }

.tabs { display: flex; gap: 16px; margin-bottom: 12px; }
.tab { padding: 10px 18px; border-radius: 8px 8px 0 0; background: #e0e0e0; cursor: pointer; font-weight: 500; transition: background 0.2s; }
.tab.active { background: #fff; box-shadow: 0 -2px 4px rgba(0,0,0,0.08); }

.card {
  background: #fff;
  border-radius: 12px;
  padding: 18px;
  border: 1px solid #e0e0e0;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

.controls { display: flex; gap: 8px; margin-bottom: 12px; }
.controls input[type="search"] {
  padding: 8px 12px;
  border-radius: 8px;
  border: 1px solid #ccc;
  color: #222;
  /*flex: 1 1 auto;*/
  flex: none;
  width: 25%;
  margin: 0 auto 12px auto;
  margin-left: 14%;
  transition: border-color 0.2s;
}
.controls input[type="search"]:focus { border-color: #007bff; outline: none; }

table {
  width: 80%;
  margin: 0 auto;
  border-collapse: collapse;
  display: block;
  overflow-x: auto;
  white-space: nowrap;
  scrollbar-width: thin;
  scrollbar-color: #b0b0b0 #f1f1f1;
  margin-left: 14%;
}
table::-webkit-scrollbar { height: 10px; }
table::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 8px; }
table::-webkit-scrollbar-thumb { background-color: #b0b0b0; border-radius: 8px; border: 2px solid #f1f1f1; }

thead th {
  position: sticky;
  top: 0;
  background: #f0f2f5;
  padding: 12px 10px;
  text-align: left;
  font-size: 13px;
  border-bottom: 1px solid #ddd;
  cursor: pointer;
  user-select: none;
}
tbody td { padding: 10px; font-size: 13px; border-bottom: 1px solid #eee; }
tbody tr:nth-child(odd) { background: #fff; }
tbody tr:nth-child(even) { background: #f9f9f9; }

.hidden { display: none; }

.bar-container {
  display: flex;
  height: 20px;
  width: 150px;
  border-radius: 8px;
  overflow: hidden;
  background: #f0f0f0;
  font-size: 11px;
  color: #fff;
  position: relative;
}
.bar { height: 100%; text-align: center; line-height: 20px; white-space: nowrap; overflow: hidden; }
.compilation-errors { background: #ff6b6b; }
.jpf-errors { background: #ffa94d; }
.passes { background: #51cf66; }

/* Tooltip */
.bar-container:hover .tooltip {
  display: block;
}
.tooltip {
  display: none;
  position: absolute;
  top: -26px;
  left: 0;
  background: rgba(0,0,0,0.75);
  color: #fff;
  padding: 2px 6px;
  font-size: 11px;
  border-radius: 4px;
}

.legend {
  display: flex;
  gap: 12px;
  margin-bottom: 12px;
  font-size: 13px;
}
.legend-item {
  display: flex;
  align-items: center;
  gap: 4px;
}
.legend-color {
  width: 16px;
  height: 16px;
  border-radius: 4px;
}
.button-group a:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}
.compilation-color { background: #ff6b6b; }
.jpf-color { background: #ffa94d; }
.passes-color { background: #51cf66; }
.hidden-column {
  display: none;
}
.copyBib {
  display: none;
}
</style>
</head>
<body>
<div class="container">
<header>
<header style="text-align:center; margin-bottom:24px;">
  <h1 style="font-size:42px; font-weight:600; margin-bottom:8px;">CONCUR</h1>
  <p class="lead" style="margin:0 0 12px; color:#555; font-size:14px;">
    Benchmark for concurrent code generation by LLMs.
  </p>

  <div class="button-group" style="display:inline-flex; gap:12px;">
<!--    <a href="#dataset" style="-->
<!--        display:flex; align-items:center; gap:6px; padding:8px 14px;-->
<!--        background: linear-gradient(135deg,#42a5f5,#1976d2);-->
<!--        color:white; border-radius:8px; text-decoration:none;-->
<!--        box-shadow: 0 2px 6px rgba(0,0,0,0.15); transition: all 0.2s;">-->
<!--      <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M2 2v12h12V2H2zm11 11H3V3h10v10z"/></svg>-->
<!--      Dataset-->
<!--    </a>-->
    <a href="https://anonymous.4open.science/r/CONCUR-41D6/README.md" style="
        display:flex; align-items:center; gap:6px; padding:8px 14px;
        background: linear-gradient(135deg,#66bb6a,#388e3c);
        color:white; border-radius:8px; text-decoration:none;
        box-shadow: 0 2px 6px rgba(0,0,0,0.15); transition: all 0.2s;">
<!--      <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M5.854 4.146a.5.5 0 0 1 0 .708L3.707 7l2.147 2.146a.5.5 0 0 1-.708.708l-2.5-2.5a.5.5 0 0 1 0-.708l2.5-2.5a.5.5 0 0 1 .708 0zm4.292 0a.5.5 0 0 0 0 .708L12.293 7l-2.147 2.146a.5.5 0 0 0 .708.708l2.5-2.5a.5.5 0 0 0 0-.708l-2.5-2.5a.5.5 0 0 0-.708 0z"/></svg>-->
      Artifact
    </a>
<!--    <a href="#paper" style="-->
<!--        display:flex; align-items:center; gap:6px; padding:8px 14px;-->
<!--        background: linear-gradient(135deg,#ab47bc,#6a1b9a);-->
<!--        color:white; border-radius:8px; text-decoration:none;-->
<!--        box-shadow: 0 2px 6px rgba(0,0,0,0.15); transition: all 0.2s;">-->
<!--      <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 0h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm0 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H4zm1 3h6v1H5V4zm0 2h6v1H5V6zm0 2h6v1H5V8z"/></svg>-->
<!--      Paper-->
<!--    </a>-->
  </div>
</header>

<div class="tabs">
  <div class="tab active" data-target="pass1">Pass@1</div>
  <div class="tab" data-target="pass3">Pass@3</div>
<!--  <div class="tab" data-target="comparison">Comparison</div>-->
</div>

<div class="legend">
  <div class="legend-item"><div class="legend-color compilation-color"></div>Compilation Errors</div>
  <div class="legend-item"><div class="legend-color jpf-color"></div>JPF Errors</div>
  <div class="legend-item"><div class="legend-color passes-color"></div>Passes</div>
</div>

<div class="card">
  <div class="controls">
    <input id="search" type="search" placeholder="Search model name..." />
  </div>

  <!-- Pass@1 -->
  <table id="pass1" >
    <thead>
      <tr>
        <th data-key="Rank">Rank</th>
        <th data-key="Model">Model</th>
        <th data-key="CompilationErrors">Compilation Errors</th>
        <th data-key="JPFErrors">JPF Errors</th>
<!--        <th data-key="Passes">Passes</th>-->
        <th data-key="PassingRate">Passing Rate</th>
        <th data-key="CodeBLEUAll" data-label="CodeBLEU">CodeBLEU</th>
<!--        <th data-key="CodeBLEUPass">CodeBLEU (Passes)</th>-->
        <th>Proportion</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- Pass@3 -->
  <table id="pass3" class="hidden">
    <thead>
      <tr>
        <th data-key="Rank">Rank</th>
        <th data-key="Model">Model</th>
        <th data-key="CompilationErrors">Compilation Errors</th>
        <th data-key="JPFErrors">JPF Errors</th>
<!--        <th data-key="Passes">Passes</th>-->
        <th data-key="PassingRate">Passing Rate</th>
        <th data-key="CodeBLEUAll" data-label="CodeBLEU">CodeBLEU</th>
<!--        <th data-key="CodeBLEUPass">CodeBLEU (Passes)</th>-->
        <th>Proportion</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- Comparison -->
<!--  <table id="comparison" class="hidden">-->
<!--    <thead>-->
<!--      <tr>-->
<!--        <th data-key="Model">Model</th>-->
<!--        <th data-key="CompilationErrors">Compilation Errors <br>k=1/k=3</th>-->
<!--        <th data-key="JPFErrors">JPF Errors <br>k=1/k=3</th>-->
<!--&lt;!&ndash;        <th data-key="Passes">Passes k=1/k=3</th>&ndash;&gt;-->
<!--        <th data-key="PassingRate">Passing Rate <br>k=1/k=3</th>-->
<!--        <th data-key="CodeBLEUAll" data-label="CodeBLEU">CodeBLEU <br>k=1/k=3</th>-->
<!--&lt;!&ndash;        <th data-key="CodeBLEUPass">CodeBLEU Passes k=1/k=3</th>&ndash;&gt;-->
<!--      </tr>-->
<!--    </thead>-->
<!--    <tbody></tbody>-->
<!--  </table>-->
<!--</div>-->

<div style="width:60%; margin-left: 20%; background:#fff; padding:24px 0;">
  <div style="max-width:800px; margin:0 auto; padding:0 16px;">
    <h2 style="text-align:center; margin:0 0 12px 0; font-size:30px; font-weight:600;">What is CONCUR?</h2>
    <p style="margin:0; font-size:14px; line-height:1.6; color:#333;">
      Concur is a designed for benchmarking LLMs for concurrent code generation with compilation and path execution.
    </p>
<!--    <p style="margin-top:12px; font-size:14px; line-height:1.6; color:#333;">-->
<!--      <strong>Prompt type:</strong> Concurrent code generation tasks.-->
<!--    </p>-->
<!--    <p style="margin-top:12px; font-size:14px; line-height:1.6; color:#333;">-->
<!--      <strong>Context:</strong> All code generation tasks can be performed exclusively with standard packages, without the need for any third-party packages.-->
<!--    </p>-->


  </div>
</div>
<div style="width: 100%; background: #fff; padding: 24px 0;">
  <div style="max-width: 800px; margin: 0 auto; padding: 0 16px;">
    <h2 style="text-align: center; font-size: 1.5rem; font-weight: 600; margin-bottom: 16px;">
      What Errors Can Concur Find?
    </h2>
    <table class="static-table" style="width: 80%; margin: 0 auto; border-collapse: collapse; table-layout: fixed; font-size: 0.9rem;">
      <colgroup>
        <col style="width: 20%;">
        <col style="width: 80%;">
      </colgroup>
      <thead>
        <tr style="background: #f0f0f0;">
          <th style="padding: 8px; text-align: left; font-weight: 600;">ERROR TYPE</th>
          <th style="padding: 8px; text-align: left; font-weight: 600;">DESCRIPTION</th>
        </tr>
      </thead>
      <tbody>
        <tr style="background: #fff;">
          <td style="padding: 8px; font-weight: 500; vertical-align: top;">Deadlock</td>
          <td style="padding: 8px; white-space: normal; word-wrap: break-word;">
            A deadlock occurs when multiple threads are running and each thread waits indefinitely for the others to release their locks.
          </td>
        </tr>
        <tr style="background: #f9f9f9;">
          <td style="padding: 8px; font-weight: 500; vertical-align: top;">Race Condition</td>
          <td style="padding: 8px; white-space: normal; word-wrap: break-word;">
            A race condition occurs when concurrent read and write operations are performed on the same shared variable without proper synchronization.
          </td>
        </tr>
        <tr style="background: #fff;">
          <td style="padding: 8px; font-weight: 500; vertical-align: top;">Uncaught Exception</td>
          <td style="padding: 8px; white-space: normal; word-wrap: break-word;">
            A range of exceptions, in addition to common concurrency errors such as deadlocks and race conditions, may arise during the execution of concurrent programs, including all exceptions defined in the Java 8 libraries.
          </td>
        </tr>
        <tr style="background: #f9f9f9;">
          <td style="padding: 8px; font-weight: 500; vertical-align: top;">No Entry Method</td>
          <td style="padding: 8px; white-space: normal; word-wrap: break-word;">
            This error occurs when the generated code lacks a public class with a main method, leaving no appropriate entry point for execution.
          </td>
        </tr>
        <tr style="background: #fff;">
          <td style="padding: 8px; font-weight: 500; vertical-align: top;">Single Thread</td>
          <td style="padding: 8px; white-space: normal; word-wrap: break-word;">
            This error occurs when the generated code executes with one single thread. This is considered incorrect, as the prompt explicitly requires the generation of multi-threaded concurrent code.
          </td>
        </tr>
        <tr style="background: #f9f9f9;">
          <td style="padding: 8px; font-weight: 500; vertical-align: top;">Termination Error</td>
          <td style="padding: 8px; white-space: normal; word-wrap: break-word;">
            This error occurs during Java program execution in JPF, which originate not from the program itself but from JPF (e.g., failing to instantiate program variables) or from the runtime environment (e.g., system crashes caused by excessive resource usage from JPF), cause JPF to stop execution.
          </td>
        </tr>
      </tbody>
    </table>

    <p style="text-align: center; margin-top: 12px; font-size: 0.95rem;">
      For more details and results in JPF errors, see <a href="./JPFerrorboard.html" style="color: #0073e6; text-decoration: underline;">Report on Pass@1</a>.
    </p>
  </div>
</div>



  <div style="width:100%; background:#fff; padding:24px 0;">
  <div style="max-width:800px; margin:0 auto; padding:0 16px; font-size:14px; line-height:1.6;">
    <h2 style="font-size:30px; font-weight:600; margin-bottom:12px; text-align:center;">Abstract</h2>
    <p>
      Leveraging Large Language Models(LLMs) for code generation has increasingly
      emerged as a common practice in the domain of software engineering. Relevant benchmarks have been established to evaluate the code generation capabilities of LLMs. However, existing benchmarks primarily focus on single-threaded
      code, lack ability to evaluate LLMs generate concurrent code. In real scenarios, using concurrent code is a common scene in software engineering,
      with some cases even necessitating its use. Compared to single-threaded code,
      concurrent code exhibits greater complexity and concurrent programs possess unique types of bugs that do not occur in single-threaded code. Therefore,
      benchmark for evaluating single-threaded code generation cannot perform well
      in evaluating generating concurrent code. To address this, we designed a
      benchmark CONCUR specifically aimed at evaluating the capability of generating multi-threaded code. CONCUR conducts a comprehensive analysis of generated multi-threaded code across the entire process from compilation to execution,
      thereby objectively evaluating the correctness of its multi-threaded properties. We
      conducted a comprehensive evaluation of a range of LLMs, and the results demonstrate that CONCUR can uncover bugs that only manifest during the execution of
      multi-threaded code. We constructed a comprehensive evaluation dataset comprising 43 concurrency issues. The dataset includes code generation tasks that address these issues using the default JDK libraries for multi-threaded programming,
      along with the corresponding ground truth solutions validated through CONCUR.
      Overall, our work provides a novel direction for evaluating the ability of LLMs to
      generate multi-threaded code.
    </p>
  </div>
</div>


<div style="width:100%; background:#fff; padding:24px 0;">
  <div style="max-width:800px; margin:0 auto; padding:0 16px; position:relative;">
    <h2 style="text-align:left; margin-top:0; font-size:18px; font-weight:600;">Code Evaluation Framework of CONCUR.</h2>

    <div style="margin-top:16px; text-align:center;">
      <img src="Concur.png" alt="Code Evaluation Framework of CONCUR." style="max-width:100%; display:block;">
    </div>
  </div>
</div>




<div style="width:100%; background:#fff; padding:24px 0;">
  <div style="max-width:600px; margin:0 auto; padding:0 16px; position:relative;">
<!--    <h2 style="text-align:left; margin-top:0; font-size:30px; font-weight:600;">BibTeX</h2>-->

    <button id="copyBib" style="
        display: none;
        position:absolute; top:0; right:0;
        width:28px; height:28px; border:none; border-radius:6px;
        background:#9e9e9e; color:white; cursor:pointer;  align-items:center; justify-content:center;
        transition: all 0.2s;
    " title="Copy BibTeX">
      <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
        <path d="M10 1H2a1 1 0 0 0-1 1v10h1V2h8V1z"/>
        <path d="M4 3h10a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1zm0 1v10h10V4H4z"/>
      </svg>
    </button>

<!--    <pre id="bibContent" style="margin-top:36px; white-space:pre-wrap; font-family:monospace;">-->
<!--      @article{llm_evaluation,-->
<!--        title={Evaluation Results of Large Language Models},-->
<!--        author={Author Name},-->
<!--        journal={Journal/Conference Name},-->
<!--        year={2025},-->
<!--        url={https://example.com}-->
<!--      }-->
<!--    </pre>-->
  </div>
</div>


<script>
// result data
const dataPass1 = [
  {Model:"gpt-5", CompilationErrors:4, JPFErrors:6, Passes:33, PassingRate:"33/43 (76.74%)", CodeBLEUAll:0.587507, CodeBLEUPass:0.590720},
  {Model:"claude-opus-4-1", CompilationErrors:0, JPFErrors:15, Passes:28, PassingRate:"28/43 (65.12%)", CodeBLEUAll:0.584580, CodeBLEUPass:0.590718},
  {Model:"gpt-4o", CompilationErrors:6, JPFErrors:10, Passes:27, PassingRate:"27/43 (62.79%)", CodeBLEUAll:0.559714, CodeBLEUPass:0.564741},
  {Model:"phi4:14b", CompilationErrors:17, JPFErrors:3, Passes:23, PassingRate:"23/43 (53.49%)", CodeBLEUAll:0.555917, CodeBLEUPass:0.554652},
  {Model:"llama3.3:70b", CompilationErrors:15, JPFErrors:6, Passes:22, PassingRate:"22/43 (51.16%)", CodeBLEUAll:0.513822, CodeBLEUPass:0.508752},
  {Model:"qwen3:32b", CompilationErrors:10, JPFErrors:12, Passes:21, PassingRate:"21/43 (48.84%)", CodeBLEUAll:0.533032, CodeBLEUPass:0.545166},
  {Model:"codestral:22b", CompilationErrors:16, JPFErrors:8, Passes:19, PassingRate:"19/43 (44.19%)", CodeBLEUAll:0.489677, CodeBLEUPass:0.497187},
  {Model:"opencoder:8b", CompilationErrors:18, JPFErrors:8, Passes:17, PassingRate:"17/43 (39.53%)", CodeBLEUAll:0.493470, CodeBLEUPass:0.494085},
  {Model:"deepseek-r1:32b", CompilationErrors:18, JPFErrors:9, Passes:16, PassingRate:"16/43 (37.21%)", CodeBLEUAll:0.548415, CodeBLEUPass:0.541650},
  {Model:"wizardcoder:33b", CompilationErrors:13, JPFErrors:14, Passes:16, PassingRate:"16/43 (37.21%)", CodeBLEUAll:0.481709, CodeBLEUPass:0.503010},
  {Model:"mixtral:8x7b", CompilationErrors:18, JPFErrors:12, Passes:13, PassingRate:"13/43 (30.23%)", CodeBLEUAll:0.516452, CodeBLEUPass:0.549658},
  {Model:"dolphin3:8b", CompilationErrors:25, JPFErrors:5, Passes:13, PassingRate:"13/43 (30.23%)", CodeBLEUAll:0.511836, CodeBLEUPass:0.519170},
  {Model:"gemma2:27b", CompilationErrors:22, JPFErrors:8, Passes:13, PassingRate:"13/43 (30.23%)", CodeBLEUAll:0.482517, CodeBLEUPass:0.493698},
  {Model:"phind-codellama:34b", CompilationErrors:19, JPFErrors:12, Passes:12, PassingRate:"12/43 (27.91%)", CodeBLEUAll:0.461227, CodeBLEUPass:0.450440},
  {Model:"codeqwen:7b", CompilationErrors:26, JPFErrors:10, Passes:7, PassingRate:"7/43 (16.28%)", CodeBLEUAll:0.466267, CodeBLEUPass:0.442896},
  {Model:"magicoder:7b", CompilationErrors:28, JPFErrors:8, Passes:7, PassingRate:"7/43 (16.28%)", CodeBLEUAll:0.445773, CodeBLEUPass:0.476500},
  {Model:"llava:34b", CompilationErrors:37, JPFErrors:1, Passes:5, PassingRate:"5/43 (11.63%)", CodeBLEUAll:0.484219, CodeBLEUPass:0.499599},
  {Model:"vicuna:33b", CompilationErrors:35, JPFErrors:3, Passes:5, PassingRate:"5/43 (11.63%)", CodeBLEUAll:0.446593, CodeBLEUPass:0.487217},
  {Model:"mistral:7b", CompilationErrors:34, JPFErrors:6, Passes:3, PassingRate:"3/43 (6.98%)", CodeBLEUAll:0.513751, CodeBLEUPass:0.487401},
  {Model:"zephyr:7b", CompilationErrors:40, JPFErrors:1, Passes:2, PassingRate:"2/43 (4.65%)", CodeBLEUAll:0.526529, CodeBLEUPass:0.564838},
  {Model:"starcoder2:15b", CompilationErrors:35, JPFErrors:6, Passes:2, PassingRate:"2/43 (4.65%)", CodeBLEUAll:0.428584, CodeBLEUPass:0.441152},
  {Model:"codellama:34b", CompilationErrors:35, JPFErrors:8, Passes:0, PassingRate:"0/43 (0.00%)", CodeBLEUAll:0.447361, CodeBLEUPass:0.000000}
];
const dataPass3 = [
  {Model:"claude-opus-4-1", CompilationErrors:0, JPFErrors:4, Passes:39, PassingRate:"39/43 (90.70%)", CodeBLEUAll:0.585045, CodeBLEUPass:0.592410},
  {Model:"qwen3:32b", CompilationErrors:0, JPFErrors:7, Passes:36, PassingRate:"36/43 (83.72%)", CodeBLEUAll:0.552070, CodeBLEUPass:0.546906},
  {Model:"gpt-4o", CompilationErrors:2, JPFErrors:7, Passes:34, PassingRate:"34/43 (79.07%)", CodeBLEUAll:0.554107, CodeBLEUPass:0.565113},
  {Model:"phi4:14b", CompilationErrors:3, JPFErrors:6, Passes:34, PassingRate:"34/43 (79.07%)", CodeBLEUAll:0.542917, CodeBLEUPass:0.534740},
  {Model:"gpt-5", CompilationErrors:0, JPFErrors:10, Passes:33, PassingRate:"33/43 (76.74%)", CodeBLEUAll:0.584362, CodeBLEUPass:0.591823},
  {Model:"deepseek-r1:32b", CompilationErrors:7, JPFErrors:4, Passes:32, PassingRate:"32/43 (74.42%)", CodeBLEUAll:0.548317, CodeBLEUPass:0.544580},
  {Model:"codestral:22b", CompilationErrors:6, JPFErrors:6, Passes:31, PassingRate:"31/43 (72.09%)", CodeBLEUAll:0.479179, CodeBLEUPass:0.495106},
  {Model:"wizardcoder:33b", CompilationErrors:4, JPFErrors:9, Passes:30, PassingRate:"30/43 (69.77%)", CodeBLEUAll:0.476069, CodeBLEUPass:0.476771},
  {Model:"opencoder:8b", CompilationErrors:9, JPFErrors:6, Passes:28, PassingRate:"28/43 (65.12%)", CodeBLEUAll:0.494950, CodeBLEUPass:0.471892},
  {Model:"llama3.3:70b", CompilationErrors:12, JPFErrors:4, Passes:27, PassingRate:"27/43 (62.79%)", CodeBLEUAll:0.513331, CodeBLEUPass:0.511387},
  {Model:"phind-codellama:34b", CompilationErrors:9, JPFErrors:10, Passes:24, PassingRate:"24/43 (55.81%)", CodeBLEUAll:0.466543, CodeBLEUPass:0.470994},
  {Model:"codeqwen:7b", CompilationErrors:16, JPFErrors:7, Passes:20, PassingRate:"20/43 (46.51%)", CodeBLEUAll:0.472215, CodeBLEUPass:0.490967},
  {Model:"dolphin3:8b", CompilationErrors:18, JPFErrors:7, Passes:18, PassingRate:"18/43 (41.86%)", CodeBLEUAll:0.501805, CodeBLEUPass:0.520012},
  {Model:"gemma2:27b", CompilationErrors:19, JPFErrors:8, Passes:16, PassingRate:"16/43 (37.21%)", CodeBLEUAll:0.491610, CodeBLEUPass:0.490183},
  {Model:"mixtral:8x7b", CompilationErrors:10, JPFErrors:18, Passes:15, PassingRate:"15/43 (34.88%)", CodeBLEUAll:0.500697, CodeBLEUPass:0.559218},
  {Model:"magicoder:7b", CompilationErrors:19, JPFErrors:12, Passes:12, PassingRate:"12/43 (27.91%)", CodeBLEUAll:0.441981, CodeBLEUPass:0.457410},
  {Model:"codellama:34b", CompilationErrors:19, JPFErrors:12, Passes:12, PassingRate:"12/43 (27.91%)", CodeBLEUAll:0.432681, CodeBLEUPass:0.461124},
  {Model:"starcoder2:15b", CompilationErrors:10, JPFErrors:25, Passes:8, PassingRate:"8/43 (18.60%)", CodeBLEUAll:0.382847, CodeBLEUPass:0.438898},
  {Model:"llava:34b", CompilationErrors:31, JPFErrors:4, Passes:8, PassingRate:"8/43 (18.60%)", CodeBLEUAll:0.462730, CodeBLEUPass:0.466870},
  {Model:"vicuna:33b", CompilationErrors:28, JPFErrors:7, Passes:8, PassingRate:"8/43 (18.60%)", CodeBLEUAll:0.461179, CodeBLEUPass:0.465669},
  {Model:"mistral:7b", CompilationErrors:30, JPFErrors:5, Passes:8, PassingRate:"8/43 (18.60%)", CodeBLEUAll:0.511657, CodeBLEUPass:0.541255},
  {Model:"zephyr:7b", CompilationErrors:32, JPFErrors:6, Passes:5, PassingRate:"5/43 (11.63%)", CodeBLEUAll:0.546725, CodeBLEUPass:0.505840}
];
const dataComparison = dataPass1.map(p1 => {
  const p3 = dataPass3.find(d => d.Model === p1.Model);
  return {
    Model: p1.Model,
    CompilationErrors: `${p1.CompilationErrors ?? 0} / ${p3?.CompilationErrors ?? 0}`,
    JPFErrors: `${p1.JPFErrors ?? 0} / ${p3?.JPFErrors ?? 0}`,
    Passes: `${p1.Passes ?? 0} / ${p3?.Passes ?? 0}`,
    PassingRate: `${p1.PassingRate ?? '0/0 (0.00%)'} / ${p3?.PassingRate ?? '0/0 (0.00%)'}`,
    CodeBLEUAll: `${(p1.CodeBLEUAll ?? 0).toFixed(6)} / ${(p3?.CodeBLEUAll ?? 0).toFixed(6)}`,
    CodeBLEUPass: `${(p1.CodeBLEUPass ?? 0).toFixed(6)} / ${(p3?.CodeBLEUPass ?? 0).toFixed(6)}`
  };
});


let currentData = dataPass1;
let currentTableId = 'pass1';
let sortKey = 'Passes';
let ascending = false;

function renderTable() {
  const tbody = document.getElementById(currentTableId).querySelector('tbody');
  const filter = document.getElementById('search').value.toLowerCase();
  const filteredData = currentData.filter(r => r.Model.toLowerCase().includes(filter));

  filteredData.sort((a,b)=>{
    let valA = a[sortKey], valB = b[sortKey];
    if(sortKey==='PassingRate'){
    valA = parseFloat(valA.match(/\(([\d.]+)%\)/)[1]);
    valB = parseFloat(valB.match(/\(([\d.]+)%\)/)[1]);
}
    if(typeof valA==='string') valA = valA.toLowerCase();
    if(typeof valB==='string') valB = valB.toLowerCase();
    if(valA < valB) return ascending ? -1 : 1;
    if(valA > valB) return ascending ? 1 : -1;

    return 0;
  });

  tbody.innerHTML = '';
  filteredData.forEach((r,i)=>{
    const tr = document.createElement('tr');
    if(currentTableId==='comparison'){
      tr.innerHTML = `<td>${r.Model}</td><td>${r.CompilationErrors}</td><td>${r.JPFErrors}</td>
<!--<td>${r.Passes}</td>-->
<td>${r.PassingRate}</td><td>${r.CodeBLEUAll}</td>
<!--<td>${r.CodeBLEUPass}</td>-->
`;
    } else {
      const total = r.CompilationErrors + r.JPFErrors + r.Passes;
      const compPercent = total ? ((r.CompilationErrors/total)*100).toFixed(1) : 0;
      const jpfPercent = total ? ((r.JPFErrors/total)*100).toFixed(1) : 0;
      const passPercent = total ? ((r.Passes/total)*100).toFixed(1) : 0;

      tr.innerHTML = `
        <td>${i+1}</td>
        <td>${r.Model}</td>
        <td>${r.CompilationErrors}</td>
        <td>${r.JPFErrors}</td>
<!--        <td>${r.Passes}</td>-->
        <td>${r.PassingRate}</td>
        <td>${r.CodeBLEUAll.toFixed(6)}</td>
<!--        <td>${r.CodeBLEUPass.toFixed(6)}</td>-->
        <td>
          <div class="bar-container">
            <div class="bar compilation-errors" style="width:${compPercent}%">${compPercent}%</div>
            <div class="bar jpf-errors" style="width:${jpfPercent}%">${jpfPercent}%</div>
            <div class="bar passes" style="width:${passPercent}%">${passPercent}%</div>
            <div class="tooltip">C:${r.CompilationErrors}, J:${r.JPFErrors}, P:${r.Passes}</div>
          </div>
        </td>`;
    }
    tbody.appendChild(tr);
  });
}

// Tabs switch
document.querySelectorAll('.tab').forEach(tab=>{
  tab.addEventListener('click', ()=>{
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    tab.classList.add('active');

    const target = tab.dataset.target;
    currentTableId = target;
    currentData = target==='pass1' ? dataPass1 : target==='pass3' ? dataPass3 : dataComparison;

    document.querySelectorAll('table').forEach(t => {
      if (!t.classList.contains('static-table')) {
        t.classList.add('hidden');
      }
    });
    document.getElementById(target).classList.remove('hidden');

    renderTable();
  });
});

document.getElementById('copyBib').addEventListener('click', () => {
  const text = document.getElementById('bibContent').innerText;
  navigator.clipboard.writeText(text).then(() => {
    const btn = document.getElementById('copyBib');
    btn.innerHTML = `
      <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
        <path d="M13.485 1.929a.75.75 0 0 1 0 1.06L6.75 9.724l-3.485-3.485a.75.75 0 0 1 1.06-1.06l2.425 2.425 6.24-6.24a.75.75 0 0 1 1.06 0z"/>
      </svg>
    `;
    setTimeout(() => {
      btn.innerHTML = `
      <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
        <path d="M10 1H2a1 1 0 0 0-1 1v10h1V2h8V1z"/>
        <path d="M4 3h10a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1zm0 1v10h10V4H4z"/>
      </svg>
      `;
    }, 1500);
  });
});

document.getElementById('search').addEventListener('input', renderTable);

// sort function
document.querySelectorAll('thead th').forEach(th => {
  const key = th.dataset.key;
  if (!key) return;

  th.addEventListener('click', () => {
    if (sortKey === key) ascending = !ascending;
    else { sortKey = key; ascending = false; }

    th.parentElement.querySelectorAll('th').forEach(t => {
      if (!t.dataset.key) return;

      if (t.dataset.key === 'CodeBLEUAll' || t.dataset.key === 'CodeBLEUPass') {
        t.textContent = t.dataset.label;
      } else {
        t.textContent = t.dataset.key;
      }
    });

    if (th.dataset.key === 'CodeBLEUAll' || th.dataset.key === 'CodeBLEUPass') {
      th.textContent = th.dataset.label + (ascending ? ' ▲' : ' ▼');
    } else {
      th.textContent = th.dataset.key + (ascending ? ' ▲' : ' ▼');
    }

    renderTable();
  });
});


renderTable();

 const toggleBtn = document.getElementById('togglePrompt');
  const contentDiv = document.getElementById('promptContent');
  toggleBtn.addEventListener('click', () => {
    if(contentDiv.style.display === 'none'){
      contentDiv.style.display = 'block';
      toggleBtn.textContent = 'Prompt Example ▼';
    } else {
      contentDiv.style.display = 'none';
      toggleBtn.textContent = 'Prompt Example ▲';
    }
  });
</script>
</body>
</html>
